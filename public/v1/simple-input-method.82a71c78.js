parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"msmP":[function(require,module,exports) {
var t={hanzi:"",pinyin:"",result:[],pageCurrent:1,pageSize:5,pageCount:0,initDict:function(){var t=pinyinUtil.dict;if(!t.py2hz)throw"未找到合适的字典文件！";t.py2hz2={},t.py2hz2.i="i";for(var i=97;i<=123;i++){var e=String.fromCharCode(i);if(!t.py2hz[e])for(var n in t.py2hz)if(0==n.indexOf(e)){t.py2hz2[e]=t.py2hz[n];break}}},initDom:function(){var t=document.createElement("div");t.id="simle_input_method",t.className="simple-input-method",t.innerHTML='<div class="pinyin"></div><div class="result"><ol></ol><div class="page-up-down"><span class="page-up">▲</span><span class="page-down">▼</span></div></div>';var i=this;t.addEventListener("click",function(t){var e=t.target;"LI"==e.nodeName?i.selectHanzi(parseInt(e.dataset.idx)):"SPAN"==e.nodeName&&("page-up"==e.className&&i.pageCurrent>1?(i.pageCurrent--,i.refreshPage()):"page-down"==e.className&&i.pageCurrent<i.pageCount&&(i.pageCurrent++,i.refreshPage()))}),document.body.appendChild(t)},init:function(t){this.initDict(),this.initDom(),obj=document.querySelectorAll(t),this._target=document.querySelector("#simle_input_method"),this._pinyinTarget=document.querySelector("#simle_input_method .pinyin"),this._resultTarget=document.querySelector("#simle_input_method .result ol");for(var i=this,e=0;e<obj.length;e++)obj[e].addEventListener("keydown",function(t){var n=t.keyCode,r=!1;n>=65&&n<=90&&(i.addChar(String.fromCharCode(n+32),this),r=!0),n>=97&&n<=122?(i.addChar(String.fromCharCode(n),this),r=!0):8==n&&i.pinyin||8==n?(i.delChar(obj[e]),r=!0):n>=48&&n<=57&&!t.shiftKey&&i.pinyin?(i.selectHanzi(n-48),r=!0):32!=n&&0!=n||!i.pinyin?(33==n||45==n||189==n)&&i.pageCount>0&&i.pageCurrent>1?(i.pageCurrent--,i.refreshPage(),r=!0):(34==n||61==n||191==n)&&i.pageCount>0&&i.pageCurrent<i.pageCount&&(i.pageCurrent++,i.refreshPage(),r=!0):(i.selectHanzi(1),r=!0),r&&t.preventDefault()})},getSingleHanzi:function(t){return pinyinUtil.dict.py2hz2[t]||pinyinUtil.dict.py2hz[t]||""},getHanzi:function(t){var i=this.getSingleHanzi(t);if(i)return[i.split(""),t];for(var e="",n=0,r=t.length;n<r;n++)if(e+=t[n],i=this.getSingleHanzi(e)){var s=!1;if(n+1<t.length){var a=1;for(r=t.length;a<=5&&n+a<r;a++)if(this.getSingleHanzi(t.substr(0,n+a+1))){s=!0;break}}if(!s)return[i.split(""),t.substr(0,n+1)+"'"+t.substr(n+1)]}return[[],""]},selectHanzi:function(t){var i=this.result[(this.pageCurrent-1)*this.pageSize+t-1];if(i){this.hanzi+=i;var e=this.pinyin.indexOf("'");e>0?(this.pinyin=this.pinyin.substr(e+1),this.refresh()):(this._input.value+=this.hanzi,this.hide())}},refresh:function(){var t=this.getHanzi(this.pinyin.replace(/'/g,""));this.result=t[0],this.pinyin=t[1];var i=this.result.length;this.pageCurrent=1,this.pageCount=Math.ceil(i/this.pageSize),this._pinyinTarget.innerHTML=this.hanzi+this.pinyin,this.refreshPage()},refreshPage:function(){var t=this.result.slice((this.pageCurrent-1)*this.pageSize,this.pageCurrent*this.pageSize),i="",e=0;t.forEach(function(t){i+='<li data-idx="'+ ++e+'">'+t+"</li>"}),this._target.querySelector(".page-up").style.opacity=this.pageCurrent>1?"1":".3",this._target.querySelector(".page-down").style.opacity=this.pageCurrent<this.pageCount?"1":".3",this._resultTarget.innerHTML=i},addChar:function(t,i){0==this.pinyin.length&&this.show(i),this.pinyin+=t,this.refresh()},delChar:function(){if(this.pinyin.length<=1){if(this.hide(),obj&&obj[0]&&obj[0].value.length>0){var t=obj[0].value;obj[0].value=t.slice(0,t.length-1)}}else this.pinyin=this.pinyin.substr(0,this.pinyin.length-1),this.refresh()},show:function(t){var i=t.getBoundingClientRect();this._target.style.left=i.left+"px",this._target.style.top=i.top+i.height+document.body.scrollTop+"px",this._input=t,this._target.style.display="block"},hide:function(){var t=this.hanzi;this.reset(),this._target.style.display="none";var i=t;console.log("Trying to set to",i),this._input.dispatchEvent(new InputEvent("input",{target:this._input}))},reset:function(){this.hanzi="",this.pinyin="",this.result=[],this.pageCurrent=1,this.pageCount=0,this._pinyinTarget.innerHTML=""}};window.SimpleInputMethod=t;
},{}]},{},["msmP"], null)
//# sourceMappingURL=/v1/simple-input-method.82a71c78.js.map